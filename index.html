<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S≈•ahovanie Mobiln√Ωch a PC Hier - NEXUS Pro</title>
    <!-- Web Ikona (Favicon) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">
    
    <!-- Naƒç√≠tanie Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Konfigur√°cia p√≠sma a farieb pre modern√Ω tmav√Ω, futuristick√Ω vzhƒæad (Cyberpunk Ne√≥n) */
        :root {
            --primary-color: #6366f1; /* Indigo/Violet */
            --accent-color: #34d399; /* Emerald/Mint Green */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d0d1a; /* Extr√©mne tmav√© pozadie (takmer ƒçierne) */
            color: #e5e7eb; /* Svetlej≈°√≠ text */
        }
        
        /* Navigaƒçn√Ω Panel - Pridan√Ω jemn√Ω gradient pre futuristick√Ω dojem */
        .futuristic-header {
            background: linear-gradient(to right, #0d0d1a 0%, #1a1a2e 50%, #0d0d1a 100%);
            box-shadow: 0 2px 15px rgba(99, 102, 241, 0.3);
        }

        /* Vylep≈°en√Ω efekt pre karty (Futuristick√©: Viac kontrastu a ne√≥nu) */
        .card-hover {
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 2px solid #374151; /* Tmav≈°√≠, ale viditeƒæn√Ω okraj */
            background-color: #12121e; /* E≈°te tmav≈°√≠ z√°klad */
            border-radius: 0.5rem; /* Pou≈æijem rounded-lg */
        }
        .card-hover:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: 0 0 25px rgba(99, 102, 241, 0.5), 0 0 10px rgba(52, 211, 153, 0.8); /* Kombinovan√Ω Indigo a Mint Glow */
            border-color: var(--primary-color);
        }

        /* VYLEP≈†EN√â MODERN√â TLAƒåIDL√Å (Futuristick√Ω Ne√≥n Style) */
        .modern-btn {
            @apply w-full py-4 text-center font-extrabold uppercase tracking-widest block transition duration-300 transform shadow-xl relative overflow-hidden;
            border: none;
            border-radius: 0.75rem; /* rounded-xl */
        }
        .download-btn-modern {
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%); /* Emerald Gradient */
            color: #1a1a2e; /* Dark text for contrast */
            box-shadow: 0 0 20px rgba(52, 211, 153, 0.7); /* Silnej≈°√≠ tie≈à */
        }
        .download-btn-modern:hover {
            transform: translateY(-2px) scale(1.01);
            background: linear-gradient(90deg, #059669 0%, #10b981 100%);
        }
        .paid-btn-modern {
            background: linear-gradient(90deg, #f87171 0%, #ef4444 100%); /* Red Gradient */
            color: #1a1a2e;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.7); /* Silnej≈°√≠ tie≈à */
        }
        .paid-btn-modern:hover {
            transform: translateY(-2px) scale(1.01);
            background: linear-gradient(90deg, #dc2626 0%, #f87171 100%);
        }

        /* Gradient pre Banner (Futuristick√° z√≥na) */
        #main-banner {
            background: linear-gradient(135deg, #1a1a2e, #0d0d1a);
            border-left: 5px solid var(--primary-color);
            box-shadow: 0 0 50px rgba(99, 102, 241, 0.1);
        }
        
        /* CSS pre animovan√Ω kruh (Welcome Screen & Redirect) */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        /* Dynamick√Ω Progress Bar (Ne√≥n efekt) */
        #download-progress-bar {
            height: 100%;
            transition: width 0.1s linear; /* Hlad≈°√≠ pohyb */
            background-color: var(--accent-color);
            box-shadow: 0 0 15px var(--accent-color);
        }
        
        /* ≈†t√Ωl pre vybran√Ω skin pri registr√°cii */
        .skin-option {
            transition: all 0.3s;
            cursor: pointer;
            border: 3px solid transparent;
        }
        .skin-option.selected {
            border-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(52, 211, 153, 0.8);
            transform: scale(1.05);
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Navigaƒçn√Ω Panel (Header) -->
    <header class="sticky top-0 z-50 futuristic-header border-b border-indigo-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center py-4">
            <!-- Logo / N√°zov Port√°lu -->
            <h1 class="text-3xl font-black tracking-wider text-indigo-400">
                <span class="text-green-400">NEXUS</span> DOWNLOADS<span class="text-lg font-medium text-gray-500 ml-1">PRO</span>
            </h1>

            <!-- Prihl√°senie / Profil Tlaƒçidlo (Dynamick√Ω obsah) -->
            <button id="auth-btn" class="px-5 py-2 bg-indigo-600 text-white font-semibold rounded-full shadow-lg shadow-indigo-600/50 hover:bg-indigo-500 transition duration-300 transform hover:scale-105" onclick="openAuthModal('login')">
                Prihl√°si≈• sa / Register
            </button>
        </div>
    </header>

    <!-- Hlavn√Ω Obsah - Katal√≥g Hier -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">

        <!-- Banner / √övodn√° Spr√°va -->
        <div id="main-banner" class="p-8 sm:p-10 rounded-xl shadow-2xl mb-16">
            <h2 class="text-5xl font-extrabold mb-3 text-white tracking-tight">Vitajte, Hr√°ƒç.</h2>
            <p id="welcome-message" class="text-indigo-300 text-xl font-light">
                Najv√§ƒç≈°ia kni≈ænica overen√Ωch hern√Ωch s√∫borov pre **Android, iOS a PC**. Stiahnite si hru priamo zo zdroja.
            </p>
        </div>

        <!-- Sekcia Odpor√∫ƒçan√Ωch Hier -->
        <section id="featured-games" class="mb-12">
            <h3 class="text-3xl font-bold mb-10 border-l-4 border-green-400 pl-4 text-gray-200">
                <span class="text-green-400">üöÄ</span> Odpor√∫ƒçan√© & Najs≈•ahovanej≈°ie
            </h3>
            
            <div id="game-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Miesto pre Karty Hier -->
            </div>
        </section>

    </main>

    <!-- P√§tiƒçka -->
    <footer class="bg-gray-900 border-t border-gray-700 mt-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-gray-500">
            <p class="text-sm">&copy; 2025 NEXUS Mobile Pro. V≈°etky pr√°va vyhraden√©.</p>
            <p class="text-xs mt-1 opacity-70">Upozornenie: Simulovan√© s≈•ahovanie vedie k presmerovaniu na ofici√°lny obchod (Google Play / Epic Games / Roblox).</p>
        </div>
    </footer>

    <!-- MODAL PRE PRIHL√ÅSENIE / REGISTR√ÅCIU -->
    <div id="auth-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden" onclick="closeAuthModal()">
        <div class="bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 p-8 relative border border-indigo-700" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-white" onclick="closeAuthModal()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            
            <!-- TABS pre prep√≠nanie pohƒæadov -->
            <div class="flex mb-6 border-b border-indigo-700">
                <button id="tab-login" class="px-4 py-2 text-lg font-bold transition duration-300 text-indigo-300 border-b-2 border-green-400" onclick="showAuthView('login')">Prihl√°senie</button>
                <button id="tab-register" class="ml-4 px-4 py-2 text-lg font-bold transition duration-300 text-gray-400 border-b-2 border-transparent" onclick="showAuthView('register')">Registr√°cia</button>
            </div>
            
            <!-- 1. LOGIN VIEW (jednoduch√© prihl√°senie) -->
            <div id="login-view" class="auth-view">
                <h3 class="text-2xl font-bold mb-4 text-indigo-400">Prihl√°ste sa pomocou svojej prez√Ωvky</h3>
                <p class="text-gray-400 mb-5 text-sm">Zadajte svoju prez√Ωvku. Mus√≠ sa zhodova≈• s va≈°√≠m zaregistrovan√Ωm profilom.</p>
                <form onsubmit="handleLogin(event)">
                    <input type="text" id="login-nickname" class="w-full p-3 mb-4 bg-gray-700 rounded-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Zadajte svoju prez√Ωvku" required>
                    <button type="submit" class="w-full py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition duration-300 shadow-lg shadow-green-600/30">
                        Prihl√°si≈• sa
                    </button>
                </form>
            </div>
            
            <!-- 2. REGISTER VIEW (komplexn√° registr√°cia s v√Ωberom profilu) -->
            <div id="register-view" class="auth-view hidden">
                <h3 class="text-2xl font-bold mb-4 text-indigo-400">Vytvorte si svoj NEXUS Profil</h3>
                <form onsubmit="handleRegistration(event)">
                    <input type="text" id="reg-nickname" class="w-full p-3 mb-4 bg-gray-700 rounded-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Prez√Ωvka (min. 3 znaky)" required>
                    
                    <p class="text-gray-400 mb-3 font-semibold">Vyberte si svoj ≈°t√Ωl profilu (Skin):</p>
                    <div id="skin-selection" class="flex justify-around mb-6">
                        <div class="text-center skin-option selected rounded-xl p-3 bg-gray-900" onclick="selectSkin('cyber')">
                            <span class="text-4xl block">‚öõÔ∏è</span>
                            <span class="text-xs">Cyber</span>
                        </div>
                        <div class="text-center skin-option rounded-xl p-3 bg-gray-900" onclick="selectSkin('fire')">
                            <span class="text-4xl block">üî•</span>
                            <span class="text-xs">Fire</span>
                        </div>
                        <div class="text-center skin-option rounded-xl p-3 bg-gray-900" onclick="selectSkin('water')">
                            <span class="text-4xl block">üíß</span>
                            <span class="text-xs">Water</span>
                        </div>
                        <div class="text-center skin-option rounded-xl p-3 bg-gray-900" onclick="selectSkin('ice')">
                            <span class="text-4xl block">‚ùÑÔ∏è</span>
                            <span class="text-xs">Ice</span>
                        </div>
                    </div>

                    <p class="text-gray-400 mb-3 font-semibold">Obƒæ√∫ben√© ≈æ√°nre (min. 1):</p>
                    <div id="genre-selection" class="flex flex-wrap gap-2 mb-6">
                        <label class="inline-flex items-center text-sm bg-gray-700 px-3 py-1 rounded-full cursor-pointer hover:bg-gray-600">
                            <input type="checkbox" name="genre" value="FPS" class="form-checkbox text-indigo-500 border-gray-600 focus:ring-indigo-500" checked>
                            <span class="ml-2">FPS</span>
                        </label>
                        <label class="inline-flex items-center text-sm bg-gray-700 px-3 py-1 rounded-full cursor-pointer hover:bg-gray-600">
                            <input type="checkbox" name="genre" value="RPG" class="form-checkbox text-indigo-500 border-gray-600 focus:ring-indigo-500">
                            <span class="ml-2">RPG</span>
                        </label>
                        <label class="inline-flex items-center text-sm bg-gray-700 px-3 py-1 rounded-full cursor-pointer hover:bg-gray-600">
                            <input type="checkbox" name="genre" value="Strategy" class="form-checkbox text-indigo-500 border-gray-600 focus:ring-indigo-500">
                            <span class="ml-2">Strat√©gia</span>
                        </label>
                        <label class="inline-flex items-center text-sm bg-gray-700 px-3 py-1 rounded-full cursor-pointer hover:bg-gray-600">
                            <input type="checkbox" name="genre" value="Adventure" class="form-checkbox text-indigo-500 border-gray-600 focus:ring-indigo-500">
                            <span class="ml-2">Adventure</span>
                        </label>
                    </div>

                    <button type="submit" class="w-full py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg transition duration-300 shadow-lg shadow-indigo-600/30">
                        Vytvori≈• Profil a Prihl√°si≈• sa
                    </button>
                </form>
            </div>
            
            <!-- 3. LOADING VIEW (po registr√°cii) -->
            <div id="loading-view" class="auth-view hidden text-center p-10">
                <!-- Zmenen√Ω text, aby potvrdil, ≈æe pou≈æ√≠vateƒæ je u≈æ v syst√©me a ide sa prihl√°si≈• -->
                <h3 id="loading-welcome-text" class="text-3xl font-extrabold mb-6 text-green-400">Vytv√°ram V√°≈° Profil...</h3>
                <div class="flex justify-center items-center mb-6">
                    <div class="loader"></div>
                </div>
                <p class="text-gray-400 text-lg">Dokonƒçenie registr√°cie a automatick√© prihl√°senie pre s≈•ahovanie...</p>
            </div>
            
            <p id="auth-error" class="text-red-400 text-center mt-3 hidden text-sm">Chyba: </p>
        </div>
    </div>
    
    <!-- NOV√ù MODAL PRE PROFIL POU≈Ω√çVATEƒΩA S MO≈ΩNOS≈§OU ODHL√ÅSENIA -->
    <div id="profile-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden" onclick="closeProfileModal()">
        <div class="bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm mx-4 p-6 relative border border-indigo-700" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-white" onclick="closeProfileModal()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            
            <div class="text-center mb-6">
                <span id="profile-icon" class="text-6xl block mb-2">‚öõÔ∏è</span>
                <h3 id="profile-nickname" class="text-3xl font-extrabold text-indigo-400">Hr√°ƒç</h3>
                <p class="text-sm text-gray-400">Prihl√°sen√Ω Profil</p>
            </div>

            <div class="space-y-3 p-4 bg-gray-900 rounded-lg mb-6">
                <div class="flex justify-between text-sm">
                    <span class="text-gray-400">≈†t√Ωl Profilu:</span>
                    <strong id="profile-skin" class="text-green-400">Cyber</strong>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-gray-400">Obƒæ√∫ben√© ≈Ω√°nre:</span>
                    <strong id="profile-genres" class="text-white">FPS, RPG</strong>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-gray-400">Registr√°cia:</span>
                    <strong id="profile-date" class="text-white">Dnes</strong>
                </div>
            </div>

            <button onclick="handleLogout()" class="w-full py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition duration-300 shadow-lg shadow-red-600/30">
                ODHL√ÅSI≈§ SA
            </button>
        </div>
    </div>
    
    <!-- NOV√ù MODAL PRE SIMUL√ÅCIU PLATBY K√ìDOM -->
    <div id="payment-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden" onclick="closePaymentModal()">
        <div class="bg-gray-800 rounded-xl shadow-2xl w-full max-w-md mx-4 p-8 relative border border-red-600" data-game-data="" onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-white" onclick="closePaymentModal()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            
            <h3 class="text-3xl font-extrabold mb-2 text-red-400">Simul√°cia Platby</h3>
            <p id="payment-game-title" class="text-xl font-bold mb-1 text-white">Cursed Hiding</p>
            <p id="payment-game-price" class="text-lg text-gray-400 mb-6 border-b border-gray-700 pb-4">Cena: 18.63 GB</p>
            
            <form onsubmit="handlePaymentAttempt(event)">
                <p class="text-gray-300 mb-3 text-sm">Zadajte k√≥d na overenie platby a odomknutie s≈•ahovania:</p>
                <input type="text" id="payment-code-input" class="w-full p-4 mb-4 bg-gray-700 rounded-lg text-2xl text-center tracking-widest border border-gray-600 focus:ring-red-500 focus:border-red-500" placeholder="K√≥d pre simul√°ciu platby" required>
                
                <p id="payment-error-message" class="text-red-400 text-center mt-3 mb-4 hidden text-sm font-semibold"></p>
                
                <button type="submit" class="w-full py-4 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition duration-300 shadow-lg shadow-red-600/30">
                    OVERI≈§ K√ìD A S≈§AHOVA≈§
                </button>
            </form>
            <p class="text-xs text-gray-500 mt-4">Pre √∫spe≈°n√∫ simul√°ciu platby zadajte k√≥d: **NEXUSPRO2025**</p>
        </div>
    </div>
    
    <!-- MODAL PRE SIMUL√ÅCIU S≈§AHOVANIA -->
    <div id="download-simulation-modal" class="fixed inset-0 bg-black bg-opacity-90 z-[100] flex items-center justify-center hidden">
        <div class="bg-[#1a1a2e] rounded-xl shadow-2xl w-full max-w-xl mx-4 p-8 relative border-t-8 border-green-500 text-center" onclick="event.stopPropagation()">
            <h4 id="download-title" class="text-3xl font-extrabold mb-4 text-green-400">S≈•ahovanie: [N√°zov Hry]</h4>
            <p class="text-lg text-gray-300 mb-6">Prip√°jame sa k NEXUS distribuƒçn√Ωm serverom...</p>
            
            <!-- Progress Bar Container -->
            <div class="bg-gray-700 rounded-full h-8 mb-4 overflow-hidden shadow-inner">
                <div id="download-progress-bar" class="w-0 flex items-center justify-center h-full rounded-full text-xs font-bold text-gray-900">
                    <span id="download-percentage">0%</span>
                </div>
            </div>

            <!-- Detaily S≈•ahovania -->
            <div class="text-left bg-gray-900 p-4 rounded-lg border border-gray-700">
                <div class="flex justify-between font-mono text-sm mb-1">
                    <span class="text-gray-400">Stiahnut√© / Celkov√° Veƒækos≈•:</span>
                    <span id="download-size" class="text-white font-bold">0.00 MB / 0.00 GB</span>
                </div>
                <div class="flex justify-between font-mono text-sm">
                    <span class="text-gray-400">Aktu√°lna R√Ωchlos≈•:</span>
                    <span id="download-speed" class="text-green-400 font-bold">0.0 MB/s</span>
                </div>
                <div class="flex justify-between font-mono text-sm mt-2">
                    <span class="text-gray-400">Detekovan√© Zariadenie:</span>
                    <span id="device-type" class="text-indigo-400 font-bold">PC / Desktop</span>
                </div>
            </div>

            <button onclick="cancelDownload()" class="w-full mt-6 py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition duration-300 shadow-lg shadow-red-600/30">
                ZRU≈†I≈§ S≈§AHOVANIE
            </button>
        </div>
    </div>
    
    <!-- MODAL PRE ZOBRAZOVANIE SPR√ÅV (N√°hrada za alert()) -->
    <div id="message-modal-container" class="fixed inset-0 bg-black bg-opacity-70 z-[110] flex items-center justify-center opacity-0 pointer-events-none" onclick="hideMessage()">
        <div id="message-modal-content" class="bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm mx-4 p-6 relative border border-indigo-500 transform scale-95 transition-all duration-300" onclick="event.stopPropagation()">
            <h4 id="message-title" class="text-2xl font-bold mb-3 text-indigo-400">Titulok</h4>
            <p id="message-text" class="text-gray-300 mb-6"></p>
            
            <button onclick="hideMessage()" class="w-full py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition duration-300 shadow-lg">
                ZAVRIE≈§
            </button>
        </div>
    </div>


    <!-- JavaScript pre simul√°ciu, generovanie kariet a autentifik√°ciu -->
    <script>
        // --- GLOB√ÅLNY STAV ---
        let globalState = {
            isLoggedIn: false,
            userProfile: {
                nickname: null,
                skin: 'cyber', // Predvolen√Ω skin
                genres: ['FPS', 'RPG'],
                registrationDate: null
            },
        };
        let downloadInterval = null;
        let selectedSkin = 'cyber'; // Lok√°lny stav pre registraƒçn√Ω formul√°r

        // --- KON≈†TANTY ---
        const PAID_GAME_TITLE = 'Cursed Hiding'; 
        const PAYMENT_CODE = 'NEXUSPRO2025'; // Tajn√Ω k√≥d pre simul√°ciu platby
        
        const MB_TO_BYTES = 1048576; // 1 MB = 1024 * 1024 bytes
        const GB_TO_BYTES = 1073741824; // 1 GB = 1024 * 1024 * 1024 bytes
        
        // R√Ωchlosti v MB/s (dynamick√© nastavenie pre simul√°ciu)
        // AKTUALIZOVAN√â PODƒΩA PO≈ΩIADAVKY U≈Ω√çVATEƒΩA
        const DOWNLOAD_SPEEDS = {
            MOBILE: { MIN: 150, MAX: 196.33 }, 
            PC: { MIN: 15, MAX: 23.30 }     
        };
        
        const gamesData = [
            {
                title: PAID_GAME_TITLE,
                description: "Popul√°rna platen√° hra typu 'Hide and Seek'. Zadajte k√≥d pre simul√°ciu platby a spustenie s≈•ahovania.",
                platform: "PC / Mobile / Roblox",
                size: "18.63 GB",
                downloadUrl: "https://www.roblox.com/games/5374495204/Cursed-Hiding-Seek", 
                iconColor: "red",
                icon: "üëª",
                isPaid: true
            },
            { 
                title: "Call of Duty: Brothers In Arms", 
                description: "Intenz√≠vna FPS vojensk√° simul√°cia in≈°pirovan√° Call of Duty. Presmerovanie na RobloX.", 
                platform: "PC / Mobile / Roblox", 
                size: "38.66 GB",
                downloadUrl: "https://www.roblox.com/games/15077189178/Call-of-Duty-Brothers-In-Arms", 
                iconColor: "blue",
                icon: "üéñÔ∏è",
                isPaid: false
            },
            { 
                title: "Fortnite", 
                description: "Glob√°lna Battle Royale PC senz√°cia! Presmerovanie do Epic Games Store.", 
                platform: "PC / Epic Games", 
                size: "99.58 GB", 
                downloadUrl: "https://store.epicgames.com/sk/p/fortnite", 
                iconColor: "red",
                icon: "üíª" 
            },
            { 
                title: "Call of Duty: Mobile", 
                description: "Klasick√Ω FPS z√°≈æitok s r√¥znymi re≈æimami pre Android/iOS. Link vedie na Google Play.", 
                platform: "Android", 
                size: "2.1 GB", 
                downloadUrl: "https://play.google.com/store/apps/details?id=com.activision.callofduty.shooter" , 
                iconColor: "indigo",
                icon: "üéÆ"
            },
            { 
                title: "Genshin Impact", 
                description: "Epick√© fantasy RPG s otvoren√Ωm svetom. Presmerovanie do obchodu Play.", 
                platform: "iOS & Android", 
                size: "20.5 GB", 
                downloadUrl: "https://play.google.com/store/apps/details?id=com.miHoYo.GenshinImpact", 
                iconColor: "red",
                icon: "üì±"
            },
            { 
                title: "Clash Royale", 
                description: "Strategick√° kartov√° hra 1v1 v re√°lnom ƒçase. Presmerovanie na Google Play.", 
                platform: "iOS & Android", 
                size: "0.25 GB", 
                downloadUrl: "https://play.google.com/store/apps/details?id=com.supercell.clashroyale", 
                iconColor: "yellow",
                icon: "üì±"
            },
        ];

        // --- POMOCN√â FUNKCIE ---
        
        function isMobileDevice() {
            return /Mobi|Android/i.test(navigator.userAgent);
        }

        function sizeStringToBytes(sizeString) {
            const parts = sizeString.toUpperCase().split(' ');
            const value = parseFloat(parts[0]);
            const unit = parts[1];

            if (unit === 'GB') {
                return value * GB_TO_BYTES;
            } else if (unit === 'MB') {
                return value * MB_TO_BYTES;
            }
            return value; 
        }

        function formatBytes(bytes) {
            if (bytes >= GB_TO_BYTES) {
                return (bytes / GB_TO_BYTES).toFixed(2) + ' GB';
            } else if (bytes >= MB_TO_BYTES) {
                return (bytes / MB_TO_BYTES).toFixed(2) + ' MB';
            } else {
                return bytes.toFixed(0) + ' B';
            }
        }

        function formatDate(timestamp) {
            if (!timestamp) return 'Nezn√°my';
            const date = new Date(timestamp);
            return date.toLocaleDateString('sk-SK', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function getSkinIcon(skin) {
            if (skin === 'fire') return 'üî•';
            if (skin === 'water') return 'üíß';
            if (skin === 'ice') return '‚ùÑÔ∏è';
            if (skin === 'cyber') return '‚öõÔ∏è';
            return 'üë§';
        }

        // --- AUTENTIFIK√ÅCIA A UI MANA≈ΩMENT (REFAKTROROVAN√â) ---
        
        /**
         * Aktualizuje Navigaƒçn√© UI (tlaƒçidlo Prihl√°si≈•/Profil) a uv√≠taciu spr√°vu
         * na z√°klade aktu√°lneho stavu globalState.
         */
        function updateAuthUI() {
            const authBtn = document.getElementById('auth-btn');
            const welcomeMsg = document.getElementById('welcome-message');

            if (globalState.isLoggedIn && globalState.userProfile.nickname) {
                // UI pre Prihl√°sen√©ho Pou≈æ√≠vateƒæa
                const profile = globalState.userProfile;
                authBtn.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="text-2xl">${getSkinIcon(profile.skin || 'üë§')}</span>
                        <span class="font-bold">${profile.nickname}</span>
                    </div>
                `;
                authBtn.onclick = () => openProfileModal();
                welcomeMsg.innerHTML = `Vitajte, <span class="text-white font-semibold">${profile.nickname}</span>! V√°≈° <span class="text-green-400 font-semibold">${profile.skin.toUpperCase()}</span> profil je pripraven√Ω na s≈•ahovanie.`;
            } else {
                // UI pre Neprihl√°sen√©ho Pou≈æ√≠vateƒæa
                authBtn.textContent = 'Prihl√°si≈• sa / Register';
                authBtn.onclick = () => openAuthModal('login');
                welcomeMsg.textContent = 'Najv√§ƒç≈°ia kni≈ænica overen√Ωch hern√Ωch s√∫borov pre Android, iOS a PC. Stiahnite si hru priamo zo zdroja.';
            }
        }
        
        /**
         * Inicializuje stav pri naƒç√≠tan√≠ str√°nky (pokus o automatick√© prihl√°senie).
         */
        function initializeAuth() {
            const storedProfile = localStorage.getItem('userProfile');
            if (storedProfile) {
                // Automatick√© prihl√°senie, ak je v prehliadaƒçi ulo≈æen√Ω profil
                globalState.userProfile = JSON.parse(storedProfile);
                globalState.isLoggedIn = true;
            } else {
                globalState.isLoggedIn = false;
            }
            updateAuthUI();
        }

        /**
         * ƒåist√© odhl√°senie. Resetuje stav v pam√§ti, ale ponech√°va registr√°ciu v localStorage.
         */
        function handleLogout() {
            closeProfileModal();
            
            // Nastavenie stavu na odhl√°sen√Ω
            globalState.isLoggedIn = false;
            // Vyƒçistenie d√°t pou≈æ√≠vateƒæa z pam√§te
            globalState.userProfile = { nickname: null, skin: 'cyber', genres: ['FPS', 'RPG'], registrationDate: null }; 
            
            renderGameCards(); // Aktualiz√°cia kariet (ak by sa mali zmeni≈•)
            updateAuthUI(); // Aktualiz√°cia navig√°cie na "Prihl√°si≈• sa / Register"
            showMessage('Odhl√°senie √öspe≈°n√©', 'Boli ste √∫spe≈°ne odhl√°sen√Ω. Pre op√§tovn√© prihl√°senie pou≈æite tlaƒçidlo vpravo hore.');
        }

        function closeAuthModal() {
            document.getElementById('auth-modal').classList.add('hidden');
            document.getElementById('auth-error').classList.add('hidden');
        }
        
        // --- PROFIL MODAL MANA≈ΩMENT ---
        
        function openProfileModal() {
            const profile = globalState.userProfile;
            const modal = document.getElementById('profile-modal');
            
            if (!globalState.isLoggedIn || !profile.nickname) return;

            document.getElementById('profile-icon').textContent = getSkinIcon(profile.skin);
            document.getElementById('profile-nickname').textContent = profile.nickname;
            document.getElementById('profile-skin').textContent = profile.skin.charAt(0).toUpperCase() + profile.skin.slice(1);
            document.getElementById('profile-genres').textContent = profile.genres.join(', ');
            document.getElementById('profile-date').textContent = formatDate(profile.registrationDate);

            modal.classList.remove('hidden');
        }

        function closeProfileModal() {
             document.getElementById('profile-modal').classList.add('hidden');
        }
        
        // --- AUTENTIFIK√ÅCIA UI MANA≈ΩMENT ---

        function showAuthView(viewName) {
            const views = document.querySelectorAll('.auth-view');
            views.forEach(view => view.classList.add('hidden'));

            const tabs = document.querySelectorAll('#auth-modal button[id^="tab-"]');
            tabs.forEach(tab => {
                tab.classList.remove('border-green-400', 'text-indigo-300');
                tab.classList.add('border-transparent', 'text-gray-400');
            });

            const targetView = document.getElementById(`${viewName}-view`);
            if (targetView) {
                 targetView.classList.remove('hidden');
            } else {
                console.error(`Pohƒæad s ID ${viewName}-view nebol n√°jden√Ω.`);
                return;
            }
            
            const tabEl = document.getElementById(`tab-${viewName}`);
            if (tabEl) {
                tabEl.classList.add('border-green-400', 'text-indigo-300');
                tabEl.classList.remove('border-transparent', 'text-gray-400');
            }
            
            document.getElementById('auth-error').classList.add('hidden');
            document.getElementById('auth-error').textContent = 'Chyba: ';
        }
        
        function openAuthModal(initialView = 'login') {
            document.getElementById('auth-modal').classList.remove('hidden');
            showAuthView(initialView);
        }
        
        function selectSkin(skin) {
            selectedSkin = skin;
            const skinOptions = document.querySelectorAll('.skin-option');
            
            skinOptions.forEach(el => {
                el.classList.remove('selected');
                
                const skinNameSpan = el.querySelector('.text-xs');
                
                if (skinNameSpan && skinNameSpan.textContent.toLowerCase() === skin.toLowerCase()) {
                    el.classList.add('selected');
                }
            });
        }

        function displayError(message) {
            const errorEl = document.getElementById('auth-error');
            errorEl.textContent = `Chyba: ${message}`;
            errorEl.classList.remove('hidden');
        }

        // --- HANDLERY FORIEM ---

        function handleLogin(event) {
            event.preventDefault();
            const enteredNickname = document.getElementById('login-nickname').value.trim();
            const storedProfileJSON = localStorage.getItem('userProfile');

            if (enteredNickname.length < 3) {
                displayError("Prez√Ωvka mus√≠ ma≈• aspo≈à 3 znaky.");
                return;
            }
            
            if (!storedProfileJSON) {
                displayError("Nena≈°iel sa ≈æiadny profil. Pros√≠m, najsk√¥r sa ZAREGISTRUJTE.");
                return;
            }

            const storedProfile = JSON.parse(storedProfileJSON);
            
            if (storedProfile.nickname.toLowerCase() !== enteredNickname.toLowerCase()) {
                displayError(`Prez√Ωvka '${enteredNickname}' sa nezhoduje s ulo≈æen√Ωm profilom. Mus√≠te zada≈• spr√°vnu prez√Ωvku.`);
                return;
            }
            
            // √öspe≈°n√© prihl√°senie: Nastavenie glob√°lneho stavu
            globalState.userProfile = storedProfile;
            globalState.isLoggedIn = true;
            
            closeAuthModal();
            updateAuthUI(); // Aktualiz√°cia UI
            showMessage('Prihl√°senie √öspe≈°n√©', `Vitajte sp√§≈•, ${storedProfile.nickname}!`);
            renderGameCards();
        }

        function handleRegistration(event) {
            event.preventDefault();
            const nickname = document.getElementById('reg-nickname').value.trim();
            const checkedGenres = document.querySelectorAll('#genre-selection input:checked');
            const genres = Array.from(checkedGenres).map(cb => cb.value);

            if (nickname.length < 3) {
                displayError("Prez√Ωvka mus√≠ ma≈• aspo≈à 3 znaky.");
                return;
            }
            if (genres.length === 0) {
                displayError("Pros√≠m, vyberte aspo≈à jeden obƒæ√∫ben√Ω ≈æ√°ner.");
                return;
            }
            
            if (localStorage.getItem('userProfile')) {
                 displayError("V prehliadaƒçi u≈æ existuje zaregistrovan√Ω profil. Ak sa chcete prihl√°si≈•, pou≈æite kartu 'Prihl√°senie'. Ak chcete zmeni≈• profil, mus√≠te najprv v profile klikn√∫≈• na **ODHL√ÅSI≈§ SA** a potom manu√°lne vymaza≈• d√°ta z prehliadaƒça, aby ste sa mohli zaregistrova≈• nanovo.");
                 return;
            }

            const newProfile = {
                nickname: nickname,
                skin: selectedSkin,
                genres: genres,
                registrationDate: Date.now() 
            };
            
            document.getElementById('loading-welcome-text').textContent = `Vytv√°ram V√°≈° Profil...`;
            showAuthView('loading');
            document.getElementById('auth-modal').onclick = () => { /* Zak√°za≈• zatvorenie */ };
            
            setTimeout(() => {
                
                // Ulo≈æenie profilu do localStorage
                localStorage.setItem('userProfile', JSON.stringify(newProfile));
                
                globalState.userProfile = newProfile;
                globalState.isLoggedIn = true;
                
                closeAuthModal();
                updateAuthUI(); 
                
                showMessage('Registr√°cia Dokonƒçen√° a Prihl√°senie √öspe≈°n√©', 
                           `Vitajte u n√°s, **${nickname}**! V√°≈° **${selectedSkin.toUpperCase()}** profil bol √∫spe≈°ne vytvoren√Ω a **automaticky prihl√°sen√Ω**.`);
                renderGameCards();
                
                document.getElementById('auth-modal').onclick = closeAuthModal;
            }, 2000); 
        }
        
        // --- NOV√â FUNKCIE PRE SIMUL√ÅCIU PLATBY ---

        function openPaymentModal(gameData) {
            if (!globalState.isLoggedIn) {
                showMessage('Chyba Pr√≠stupu', 'Pre spustenie s≈•ahovania sa mus√≠te najprv prihl√°si≈• alebo zaregistrova≈•.');
                openAuthModal('register');
                return;
            }

            const modal = document.getElementById('payment-modal');
            document.getElementById('payment-game-title').textContent = gameData.title;
            document.getElementById('payment-game-price').textContent = `Veƒækos≈•: ${gameData.size}`; 
            document.getElementById('payment-code-input').value = '';
            document.getElementById('payment-error-message').classList.add('hidden');
            
            // Ulo≈æenie d√°t hry do modal elementu pre neskor≈°ie pou≈æitie
            modal.dataset.gameData = JSON.stringify(gameData);
            modal.classList.remove('hidden');
        }

        function closePaymentModal() {
            document.getElementById('payment-modal').classList.add('hidden');
        }

        function handlePaymentAttempt(event) {
            event.preventDefault();
            const modal = document.getElementById('payment-modal');
            const inputCode = document.getElementById('payment-code-input').value.trim().toUpperCase();
            const errorEl = document.getElementById('payment-error-message');
            
            // Z√≠skanie d√°t hry
            const gameData = JSON.parse(modal.dataset.gameData);

            if (inputCode === PAYMENT_CODE) {
                closePaymentModal();
                showMessage('Platba √öspe≈°n√°', `K√≥d **${PAYMENT_CODE}** bol overen√Ω! Sp√∫≈°≈•am s≈•ahovanie hry **${gameData.title}**.`);
                // Spusti≈• simul√°ciu s≈•ahovania po √∫spe≈°nej "platbe"
                startDownloadSimulation(gameData);
            } else {
                errorEl.textContent = 'Nespr√°vny k√≥d! Pre simul√°ciu zadajte: NEXUSPRO2025';
                errorEl.classList.remove('hidden');
            }
        }
        
        // --- N√ÅHRADA ZA ALERT() ---
        
        function showMessage(title, message, callback = null) {
            const container = document.getElementById('message-modal-container');
            const content = document.getElementById('message-modal-content');
            document.getElementById('message-title').textContent = title;
            document.getElementById('message-text').innerHTML = message; 
            
            const okButton = document.querySelector('#message-modal-content button');
            okButton.onclick = () => {
                hideMessage();
                if (callback) callback();
            };

            container.classList.remove('opacity-0', 'pointer-events-none');
            content.classList.remove('scale-95');
        }

        function hideMessage() {
            const container = document.getElementById('message-modal-container');
            const content = document.getElementById('message-modal-content');
            content.classList.add('scale-95');
            container.classList.add('opacity-0');
            
            setTimeout(() => {
                container.classList.add('pointer-events-none');
            }, 300);
        }

        // --- MANA≈ΩMENT S≈§AHOVANIA (SIMUL√ÅCIA) ---
        
        function startDownloadSimulation(gameData) {
            if (!globalState.isLoggedIn) {
                showMessage('Chyba Pr√≠stupu', 'Mus√≠te by≈• prihl√°sen√Ω, aby ste mohli s≈•ahova≈•.');
                return;
            }

            const modal = document.getElementById('download-simulation-modal');
            modal.classList.remove('hidden');

            document.getElementById('download-title').textContent = `S≈•ahovanie: ${gameData.title}`;
            
            const totalBytes = sizeStringToBytes(gameData.size);
            let downloadedBytes = 0;
            const intervalTime = 100; 
            
            const isMobile = isMobileDevice();
            const speedConfig = isMobile ? DOWNLOAD_SPEEDS.MOBILE : DOWNLOAD_SPEEDS.PC;
            document.getElementById('device-type').textContent = isMobile ? 'Mobil / Tablet' : 'PC / Desktop';
            
            let currentSpeedMBps = speedConfig.MIN;
            
            const progressBar = document.getElementById('download-progress-bar');
            const percentageText = document.getElementById('download-percentage');
            const sizeText = document.getElementById('download-size');
            const speedText = document.getElementById('download-speed');
            
            progressBar.style.width = '0%';
            percentageText.textContent = '0%';
            sizeText.textContent = `0.00 MB / ${gameData.size}`;
            speedText.textContent = '0.0 MB/s';

            downloadInterval = setInterval(() => {
                
                const fluctuation = (Math.random() - 0.5) * 2; 
                currentSpeedMBps = Math.max(speedConfig.MIN, Math.min(speedConfig.MAX, currentSpeedMBps + fluctuation));
                
                const bytesDownloadedInStep = currentSpeedMBps * MB_TO_BYTES * (intervalTime / 1000);
                
                downloadedBytes += bytesDownloadedInStep;

                if (downloadedBytes >= totalBytes) {
                    clearInterval(downloadInterval);
                    downloadInterval = null;
                    downloadedBytes = totalBytes; 
                    
                    const percentage = 100;
                    progressBar.style.width = percentage + '%';
                    percentageText.textContent = `${percentage.toFixed(0)}% DOKONƒåEN√â`;
                    speedText.textContent = '0.0 MB/s (Hotovo)';
                    sizeText.textContent = `${formatBytes(downloadedBytes)} / ${formatBytes(totalBytes)}`;
                    
                    setTimeout(() => {
                        modal.classList.add('hidden');
                        showMessage('S≈•ahovanie Dokonƒçen√©', `Hra '${gameData.title}' bola simulovane stiahnut√°! Budete presmerovan√Ω do ofici√°lneho obchodu.`, () => {
                             window.open(gameData.downloadUrl, '_blank');
                        });
                    }, 1000); 
                    
                } else {
                    const percentage = (downloadedBytes / totalBytes) * 100;
                    progressBar.style.width = percentage + '%';
                    percentageText.textContent = `${percentage.toFixed(1)}%`;
                    
                    sizeText.textContent = `${formatBytes(downloadedBytes)} / ${formatBytes(totalBytes)}`;
                    speedText.textContent = `${currentSpeedMBps.toFixed(2)} MB/s`;
                }

            }, intervalTime);
        }

        function cancelDownload() {
            if (downloadInterval) {
                clearInterval(downloadInterval);
                downloadInterval = null;
            }
            document.getElementById('download-simulation-modal').classList.add('hidden');
            showMessage('S≈•ahovanie Zru≈°en√©', 'S≈•ahovanie bolo preru≈°en√©. M√¥≈æete zaƒça≈• s≈•ahova≈• znova.');
        }
        
        function handleGameAction(gameData) {
            if (!globalState.isLoggedIn) {
                showMessage('Chyba Pr√≠stupu', 'Pre spustenie s≈•ahovania sa mus√≠te najprv prihl√°si≈• alebo zaregistrova≈•.');
                openAuthModal('register');
                return;
            }
            
            // Ak je hra platen√°, otvor√≠ platobn√Ω modal
            if (gameData.isPaid) {
                openPaymentModal(gameData); 
                return;
            }

            // Inak spust√≠ s≈•ahovanie priamo
            startDownloadSimulation(gameData);
        }


        // --- GENER√ÅCIA A RENDERING KARIET HIER ---

        function renderGameCards() {
            const container = document.getElementById('game-grid');
            container.innerHTML = '';
            
            gamesData.forEach(game => {
                let buttonHtml;
                // Vytvorenie JSON stringu pre prenos d√°t hry do handleru
                const gameDataJson = JSON.stringify(game).replace(/"/g, '&quot;');
                let buttonHandler = `handleGameAction(${gameDataJson})`;

                if (game.isPaid) {
                    buttonHtml = `
                        <button onclick="${buttonHandler}" class="modern-btn paid-btn-modern">
                            üõí K√öPI≈§ A HRA≈§ (${game.size})
                        </button>
                    `;
                } else {
                    buttonHtml = `
                        <button onclick="${buttonHandler}" class="modern-btn download-btn-modern">
                            ‚Üì STIAHNU≈§ A HRA≈§ (${game.size})
                        </button>
                    `;
                }

                const card = document.createElement('div');
                const platformColorClass = game.iconColor === 'yellow' ? 'text-yellow-400' : 
                                           game.iconColor === 'red' ? 'text-red-400' : 
                                           game.iconColor === 'blue' ? 'text-blue-400' : 'text-indigo-400';

                card.className = 'card-hover rounded-lg shadow-xl p-6 flex flex-col justify-between';
                card.innerHTML = `
                    <div>
                        <!-- Ikona Hry a Platforma -->
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-5xl">${game.icon}</span>
                            <span class="text-xs font-semibold uppercase px-3 py-1 bg-gray-700 ${platformColorClass} rounded-full shadow-inner">${game.platform}</span>
                        </div>
                        
                        <!-- N√°zov a Popis -->
                        <h4 class="text-xl font-bold mb-2 text-white">${game.title}</h4>
                        <p class="text-gray-400 text-sm mb-6">${game.description}</p>
                    </div>
                    
                    <!-- Akƒçn√© Tlaƒçidl√° -->
                    <div class="mt-auto">
                        ${buttonHtml}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // --- INICIALIZ√ÅCIA ---

        window.onload = function() {
            initializeAuth(); // Naƒç√≠tanie stavu a d√°t pri ≈°tarte
            renderGameCards();
            
            selectSkin('cyber');
        };

    </script>
</body>
</html>












